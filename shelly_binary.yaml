# mqtt_devices.yaml
#
# Copyright (C) 2022 Daniele Bochicchio, All Rights Reserved
# For updates see https://github.com/dbochicchio/reactor-mqtt-contrib
#
# *** IMPORTANT ***
# Just copy this file under reactor/config/mqtt_templates. 
# If mqtt_templates directory does not exist, simply create it.
# Copy the files and restart Reactor. Every time you update the files, a restart is needed.
---
version: 22324
revision: 1
format: 1

templates:
  # Shelly with detached inputs, mapped as binary sensor
  shelly_binary:
    type: BinarySensor
    capabilities: ['binary_sensor']
    primary_attribute: binary_sensor.state
    requires: [topic, channel]
    description: Shelly with detached inputs, mapped as binary sensor
    contributor_name: Daniele Bochicchio
    contributor_url: https://github.com/dbochicchio/reactor-mqtt-contrib
    lwt: "tele/%topic%/LWT"
    init:
      - topic: "shellies/%topic%/command"
        payload:
          update: true
        type: json
        qos: 0
        retain: false
    events:
      "shellies/%topic%/input/%channel%":
        "binary_sensor.state":
          expr: 'float(payload) == 1'